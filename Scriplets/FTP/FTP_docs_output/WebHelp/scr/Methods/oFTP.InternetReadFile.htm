<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<title>oFTP.InternetReadFile()</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="commands.css" rel="stylesheet" type="text/css">
<link href="print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body><script language="JavaScript" type="text/JavaScript">
function syn(){
if(parent.nav.tree){
 if(parent.nav.tree.loaded){
  parent.nav.tree.selectNode(18);
 }else{
  setTimeout("syn()",500);
}
  }else{
  setTimeout("syn()",500);
  }}
if(parent!=self){
  setTimeout("syn()",100);
}else{
  parent.location.href = "../../index.htm#page=Methods/oFTP.InternetReadFile.htm";
}
originalOnload = window.onload;
if(originalOnload==null){
window.onload = function(){parent.contentLoaded = true;};
}else{
window.onload = function(){originalOnload();parent.contentLoaded = true;};
}
</script> 


<h1>oFTP.InternetReadFile()</h1>
<hr size="2">
<p>Downloads a file (with progress bar)</p>

<p class="CommandSyntax">oFTP.InternetReadFile(RemoteFile, &#91;NewLocalFile, FnProgress&#93;)</p>
<h4>Parameters</h4>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
<tr>
<td width="15%">RemoteFile</td>
<td width="85%"><p>Path of remote file to download</p></td>
</tr>
<tr>
<td width="15%">NewLocalFile</td>
<td width="85%"><p><i>(Optional)</i> Local file name/path (if omitted, defaults to name of remote file, saved to script directory)</p></td>
</tr>
<tr>
<td width="15%">FnProgress</td>
<td width="85%"><p><i>(Optional)</i> Name of function to handle progress data (similar to registercallback). If not specified, built in function to show progress is used. (see example)</p></td>
</tr>
</table>
<h4>Return Value</h4>
True on success, false otherwise.
<h4>Remarks</h4>
<p>Use .LastError property to get error data</p>
<h4>Properties set by this method</h4>
<table border="1" bordercolor="#c0c0c0" cellpadding="3" cellspacing="0" width="100%">
<tbody><tr></tr>
<tr><td width="25%">.File.BytesTransfered</td><td width="75%"><p>&nbsp;Bytes transfered<br></p></td></tr>
<tr><td width="25%">.File.BytesTotal</td><td width="75%"><p>&nbsp;Total bytes to transfer<br></p></td></tr>
<tr><td width="25%">.File.LocalName</td><td width="75%"><p>&nbsp;Name of local file<br></p></td></tr>
<tr><td width="25%">.File.RemoteName</td><td width="75%"><p>&nbsp;Name of remote file<br></p></td></tr>
<tr><td width="25%">.File.StartTime</td><td width="75%"><p>&nbsp;Tick count at start of transfer<br></p></td></tr>
<tr><td width="25%">.File.CurrentTime</td><td width="75%"><p>&nbsp;Current tick count<br></p></td></tr>
<tr><td width="25%">.File.TransferComplete</td><td width="75%"><p>&nbsp;Transfer is complete<br></p></td></tr>
</tbody></table>
<h4>Related</h4>
<p><a href=".\oFTP.InternetWriteFile.htm">oFTP.InternetWriteFile()</a></p>
<h4>Example</h4>
<pre class="NoIndent">oFTP.InternetReadFile(&quot;RTestFile.zip&quot;, &quot;LTestFile.zip&quot;, &quot;MyProgressFunction&quot;)

MyProgressFunction() {
global oFTP
my := oFTP.File
static init
done := my.BytesTransfered
total := my.BytesTotal
if ( my.TransferComplete )
&nbsp;&nbsp;{
&nbsp;&nbsp;Progress, Off
&nbsp;&nbsp;init := 0
&nbsp;&nbsp;return 1
&nbsp;&nbsp;}
str_sub := &quot;Time Elapsed - &quot; . Round((my.CurrentTime - my.StartTime)/1000) . &quot; seconds&quot;
if !init
&nbsp;&nbsp;{
&nbsp;&nbsp;str_main := my.LocalName . A_Tab . &quot;-&amp;&#35;62;&quot; . A_Tab . my.RemoteName
&nbsp;&nbsp;Progress,B R0-%total% P%done%,%str_sub%, %str_main% ,FTP Transfer Progress
&nbsp;&nbsp;init :=1
&nbsp;&nbsp;return 1
&nbsp;&nbsp;}
Progress, %done%
Progress,,%str_sub%
}</pre>

</body>
</html>